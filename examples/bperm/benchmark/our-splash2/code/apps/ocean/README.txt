This version includes:
 - non_contiguous_partitions
 - Use 1 barriers
