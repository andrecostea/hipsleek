# ex3a-ato-err.slk

fixing log:
1. tp_imply_no_cache


Difference below seems to be due to starting Omega?



Why does --ato trigger these pairwisecheck?

(====)
Omega.pairwisecheck@2@1
Omega.pairwisecheck inp1 : f___hole_1
Omega.pairwisecheck@2 EXIT: 1<=f___hole_1

(==trans_arr.ml#2159==)
om_pairwisecheck@1
om_pairwisecheck inp1 : forall(i:(i!=3 | (a[i-1])<(a[i])))
om_pairwisecheck@1 EXIT: forall(i:(i!=3 | (a[i-1])<(a[i])))

!!! **sleekcore.ml#222:arrvar_flag:false
Starting Omega.../usr/local/bin/oc

without --ato
Entail (1) : Valid. 
Residue:
 <1>emp&i=3 & forall(i:(i!=3 | (a[i-1])<(a[i])))&{FLOW,(4,5)=__norm#E}[]
 inferred pure: [forall(i:(i!=3 | (1+(a[i-1]))<=(a[i])))]

with --ato
Entail (1) : Fail.(may) cause: i=3 |-  (a[i-1])<(a[i]). LOCS:[1] (may-bug)
Residue:
MaybeErr Context: 
                   fe_kind: MAY
                   fe_name: logical bug
                   fe_locs: {
                             fc_message:  i=3 |-  (a[i-1])<(a[i]). LOCS:[1] (may-bug)
                             fc_current_lhs_flow: {FLOW,(4,5)=__norm#E}}
[[empty]]
CEX:false
===================================================================
# ex11a0.ss (FIXED with --dis-type-err flag)

Add a flag --ignore-type-err for this. Otherwise should fail
by default.

ERROR: at ex11a0-infer-pre-post-arr-get.ss_8:33_8:34
Message: UNIFICATION ERROR : at location {(Line:8,Col:33),(Line:8,Col:34)} types int[] and int are inconsistent

===================================================================
# ex11a2.ss -tp z3 --smtinp (FIXED by Loc in error_inf)

Why did we generate P twice?

WARNING: _0:0_0:0:Z3 error message: 
(error "line 304 column 25: invalid declaration, function 'P' (whith the given signature) already declared")

Checking procedure foo$int[]... 
!!! **wrapper.ml#271:Calling wrap_arr_as_var
WARNING: _0:0_0:0:Z3 error message: 
(error "line 304 column 25: invalid declaration, function 'P' (whith the given signature) already declared")
>>> GENERATED SMT INPUT:

;Variables declarations
(declare-fun a_primed () (Array Int Int))
(declare-fun a () (Array Int Int))
(declare-fun v_int_11_1152_primed () Int)
;Relations declarations
(declare-fun P (Int) Bool)
(declare-fun P (Int) Bool)
;Axioms assertions
;Antecedent
(assert (= a_primed a))
(assert (P (select a 5)))
(assert (= v_int_11_1152_primed 5))
;Negation of Consequence
(assert (not false))
(check-sat)
===================================================================
# ex11d.ss 

int foo(ref int[] a)
  infer [@arrvar,P,Q,update_array_1d] requires P(a) ensures Q(a,a',res);
{
  a[5]=10;
  return a[4];
}

Correct RElDEFN:
[RELDEFN Q: ( a'[4]=res & update_array_1d(a,a',10,5) & P(a)) 
     -->  Q(a,a',res)]

# However, it seems we cannot handle update_array_Id subsequently..

ERROR: at _0:0_0:0
Message: compute_def:Error in translating the input for fixcalc
!!! PROBLEM with fix-point calculation
ExceptionFailure("compute_def:Error in translating the input for fixcalc")Occurred!
Error1(s) detected at main 
Stop Omega... 46 invocations caught

===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
===================================================================
